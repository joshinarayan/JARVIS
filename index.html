<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
    background:#000;
    color:white;
    margin:0;
    font-family:Arial;
    display:flex;
    flex-direction:column;
    height:100vh;
}

#scanner{
    width:180px;height:180px;margin:20px auto;
    border-radius:50%;border:4px solid #00ff95;
    animation:pulse 2s infinite;
    box-shadow:0 0 25px #00ff95;
}
@keyframes pulse{
 0%{transform:scale(1);}50%{transform:scale(1.1);}100%{transform:scale(1);}
}

#chat-box{
 flex:1;overflow-y:auto;padding:10px;font-size:17px;
}
.message{margin-bottom:10px;padding:8px;border-radius:6px;max-width:80%;}
.user{background:#0066ff44;margin-left:auto;}
.bot{background:#00ff9544;}

#input-area{
 position:fixed;bottom:0;width:100%;display:flex;background:#111;padding:10px;
}
#user-input{
 flex:1;padding:12px;font-size:18px;background:#222;border:none;color:white;
}
button{
 padding:12px;background:#00ff95;border:none;color:black;font-weight:bold;font-size:18px;margin-left:6px;
}
</style>
</head>

<body>

<div id="scanner"></div>
<div id="chat-box"></div>

<div id="input-area">
   <input id="user-input" placeholder="Speak to me sir..."/>
   <button onclick="sendMessage()">Send</button>
</div>

<script>
let voiceGender="male";

function speak(text){
    const msg=new SpeechSynthesisUtterance(text);
    msg.rate=1.05;
    msg.pitch= voiceGender==="male" ? 0.8 : 1.3;
    speechSynthesis.speak(msg);
}

function addMessage(text,type){
   const box=document.getElementById("chat-box");
   const msg=document.createElement("div");
   msg.className="message "+type;
   msg.innerText=text;
   box.appendChild(msg);
   box.scrollTop=box.scrollHeight;
   return msg;
}

async function sendMessage(){
    const input=document.getElementById("user-input");
    const text=input.value.trim();
    if(!text) return;

    addMessage(text,"user");
    const botMsg=addMessage("Processing sir...","bot");
    input.value="";

    try{
       const res=await fetch("https://jarvis-backend-lllv.onrender.com/api/ask",{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({prompt:text})
       });

       const data=await res.json();
       botMsg.innerText=data.reply;
       speak(data.reply);
    }catch{
       botMsg.innerText="Connection failed sir.";
    }
}
</script>

</body>
</html>
